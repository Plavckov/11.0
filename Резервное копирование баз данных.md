### Задание 1. Резервное копирование

### Кейс
Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования. 

Необходимо описать, какие варианты резервного копирования подходят в случаях: 

1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.

1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.

1.3.* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую или починенную базу данных.

*Приведите ответ в свободной форме.*

1.1. Полное резервное копирование (Идеально, при условии, что бэкап делается ежедневно), все остальные виды копирования 
тоже подойдут, но скорей всего будут избыточны или недостаточными;

1.2.  Если будет известно что в течении часа произойдет какая либо поломка, лучше всего будет произвести полное резервное копирование и за пол часа произвести дифференциальное копирование. Данный метод поможет восстановить данные не только часом позднее,но и более свежие. Если известен только день возможной поломки. то произвести полное резервное коппирование, и установить дифференциальное копирование каждые пол часа с сохранением последнего и удалением остальных, что поможет, если во время последнего дифференциальное копирование произойдет сбой, всегда будет предыдущий, с которорго будет произведено максимальное восстановление данных  



---

### Задание 2. PostgreSQL

2.1. С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).

2.1.* Возможно ли автоматизировать этот процесс? Если да, то как?

*Приведите ответ в свободной форме.*

`pg_dump -U {user_name} {database_name} > /tmp/{database_name}.dump`

`pg_restore -d {database_name} /tmp/{database_name}.dump`

Что касается автоматизации вариантов много, самый популярный это cronjob. Менее популярный (по крайней мере я такого не 
видел) - это по событию (сохранение, удаление, обновление).

---

### Задание 3. MySQL

3.1. С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL. 

3.1.* В каких случаях использование реплики будет давать преимущество по сравнению с обычным резервным копированием?

*Приведите ответ в свободной форме.*

1. Активируем Binary Logging

`nano /etc/mysql/mysql.conf.d/mysqld.cnf`
```
log_bin = /var/log/mysql/mysql-bin.log
expire_logs_days = 10
```
2. Создаем базу с именем {database_name}
3. Делаем полную копию
```
mysqldump -u {user_name} -p --all-databases --single-transaction --flush-logs --master-data=2 > {dump_name}.sql
```


В целом реплика почти всегда будет лучше кроме вариантов когда она начала сильно отставать, записала битые данные, 
или упала.


---
